---
import type { Props } from "@astrojs/starlight/props";

const { pathname } = Astro.url;
const isDocsPage = pathname.startsWith("/docs");

const productsList = [
  { to: "/product/notepad", label: "Notepad" },
  { to: "/product/memory", label: "Memory", badge: "Coming Soon" },
  { to: "/product/bot", label: "Bot", badge: "Coming Soon" },
  { to: "/product/api", label: "API", badge: "Coming Soon" },
  { to: "/product/extensions", label: "Extensions", badge: "Coming Soon" },
];

const featuresList = [
  { to: "/product/ai-notetaking", label: "AI Notetaking" },
  { to: "/product/ai-assistant", label: "AI Assistant" },
  { to: "/product/mini-apps", label: "Mini Apps" },
  { to: "/gallery", label: "Templates & Shortcuts" },
  { to: "/product/integrations", label: "Integrations", badge: "Coming Soon" },
];
---

<header class="header-wrapper">
  <div class="header-container">
    <div class="header-content">
      <div class="left-nav">
        <a href="/" class="logo">
          <img src="/api/images/hyprnote/logo.svg" alt="Hyprnote" />
        </a>

        <div class="product-dropdown">
          <button class="nav-link dropdown-trigger">
            Product
            <svg
              class="chevron-down"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="m6 9 6 6 6-6"></path>
            </svg>
            <svg
              class="chevron-up"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="m18 15-6-6-6 6"></path>
            </svg>
          </button>
          <div class="dropdown-menu">
            <div class="dropdown-content">
              <div class="dropdown-section">
                <div class="dropdown-section-title">Products</div>
                {
                  productsList.map((link) => (
                    <a href={link.to} class="dropdown-link">
                      <span>{link.label}</span>
                      {link.badge && <span class="badge">{link.badge}</span>}
                    </a>
                  ))
                }
              </div>
              <div class="dropdown-section">
                <div class="dropdown-section-title">Features</div>
                {
                  featuresList.map((link) => (
                    <a href={link.to} class="dropdown-link">
                      <span>{link.label}</span>
                      {link.badge && <span class="badge">{link.badge}</span>}
                    </a>
                  ))
                }
              </div>
            </div>
          </div>
        </div>

        <a
          href="/docs"
          class:list={["nav-link", { active: isDocsPage }]}
          data-nav="docs">Docs</a
        >
        <a href="/blog" class="nav-link" data-nav="blog">Blog</a>
        <a href="/pricing" class="nav-link" data-nav="pricing">Pricing</a>
        <a href="/enterprise" class="nav-link" data-nav="enterprise"
          >Enterprise</a
        >
      </div>

      <nav class="right-nav">
        <button class="search-trigger" aria-label="Search">
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.3-4.3"></path>
          </svg>
          <span class="search-shortcut">
            <kbd>âŒ˜</kbd>
            <kbd>K</kbd>
          </span>
        </button>
        <a href="/download/apple-silicon" class="cta-button" download>
          Download
        </a>
      </nav>

      <button class="mobile-menu-button" aria-label="Open menu">
        <svg
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <line x1="4" x2="20" y1="12" y2="12"></line>
          <line x1="4" x2="20" y1="6" y2="6"></line>
          <line x1="4" x2="20" y1="18" y2="18"></line>
        </svg>
      </button>
    </div>
  </div>
</header>

<style>
  .header-wrapper {
    position: sticky;
    top: 0;
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(8px);
    border-bottom: 1px solid #f5f5f4;
    z-index: 50;
    height: 69px;
  }

  .header-container {
    max-width: 72rem;
    margin: 0 auto;
    padding: 0 1rem;
    border-left: 1px solid #f5f5f4;
    border-right: 1px solid #f5f5f4;
    height: 100%;
  }

  @media (min-width: 72rem) {
    .header-container {
      padding: 0;
    }
  }

  .header-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 100%;
  }

  .left-nav {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .logo {
    font-weight: 600;
    font-size: 1.5rem;
    font-family: serif;
    margin-right: 1rem;
    transition: transform 0.2s;
  }

  .logo:hover {
    transform: scale(1.05);
  }

  .logo img {
    height: 1.5rem;
  }

  .nav-link {
    display: none;
    font-size: 0.875rem;
    color: #525252;
    transition: color 0.2s;
    text-decoration: none;
  }

  .nav-link:hover {
    color: #292524;
    text-decoration: underline;
    text-decoration-style: dotted;
  }

  .nav-link.active {
    text-decoration: underline;
    text-decoration-style: dotted;
  }

  @media (min-width: 640px) {
    .nav-link[data-nav="blog"],
    .nav-link[data-nav="pricing"] {
      display: block;
    }
  }

  @media (min-width: 768px) {
    .nav-link[data-nav="docs"],
    .nav-link[data-nav="enterprise"] {
      display: block;
    }
  }

  .product-dropdown {
    position: relative;
    display: none;
  }

  @media (min-width: 640px) {
    .product-dropdown {
      display: block;
    }
  }

  .dropdown-trigger {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.875rem;
    color: #525252;
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.5rem 0;
    transition: color 0.2s;
  }

  .dropdown-trigger:hover {
    color: #292524;
  }

  .chevron-up {
    display: none;
  }

  .product-dropdown:hover .chevron-down {
    display: none;
  }

  .product-dropdown:hover .chevron-up {
    display: block;
  }

  .dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    padding-top: 0.5rem;
    width: 32rem;
    z-index: 50;
    display: none;
  }

  .product-dropdown:hover .dropdown-menu {
    display: block;
  }

  .dropdown-content {
    background: white;
    border: 1px solid #e5e5e5;
    border-radius: 0.125rem;
    box-shadow:
      0 10px 15px -3px rgba(0, 0, 0, 0.1),
      0 4px 6px -4px rgba(0, 0, 0, 0.1);
    padding: 0.5rem;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
  }

  .dropdown-section {
    padding: 0.75rem;
  }

  .dropdown-section-title {
    font-size: 0.75rem;
    font-weight: 600;
    color: #a3a3a3;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 0.5rem;
  }

  .dropdown-link {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.5rem 0;
    font-size: 0.875rem;
    color: #404040;
    text-decoration: none;
  }

  .dropdown-link:hover span:first-child {
    text-decoration: underline;
    text-decoration-style: dotted;
  }

  .badge {
    font-size: 0.625rem;
    background: linear-gradient(to top, #e5e5e5, #f5f5f5);
    color: #171717;
    padding: 0.125rem 0.5rem;
    border-radius: 9999px;
  }

  .right-nav {
    display: none;
    align-items: center;
    gap: 1rem;
  }

  @media (min-width: 640px) {
    .right-nav {
      display: flex;
    }
  }

  .search-trigger {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 0.75rem;
    background: none;
    border: 1px solid #e5e5e5;
    border-radius: 0.375rem;
    cursor: pointer;
    color: #525252;
    transition: all 0.2s;
  }

  .search-trigger:hover {
    border-color: #d4d4d4;
    background: #fafafa;
  }

  .search-shortcut {
    display: flex;
    gap: 0.25rem;
  }

  .search-shortcut kbd {
    font-size: 0.75rem;
    padding: 0.125rem 0.375rem;
    background: #f5f5f5;
    border: 1px solid #e5e5e5;
    border-radius: 0.25rem;
    font-family: inherit;
  }

  .cta-button {
    display: flex;
    align-items: center;
    padding: 0 1rem;
    height: 2rem;
    font-size: 0.875rem;
    background: linear-gradient(to top, #57534e, #78716c);
    color: white;
    border-radius: 9999px;
    text-decoration: none;
    box-shadow:
      0 4px 6px -1px rgba(0, 0, 0, 0.1),
      0 2px 4px -2px rgba(0, 0, 0, 0.1);
    transition: all 0.2s;
  }

  .cta-button:hover {
    box-shadow:
      0 10px 15px -3px rgba(0, 0, 0, 0.1),
      0 4px 6px -4px rgba(0, 0, 0, 0.1);
    transform: scale(1.02);
  }

  .cta-button:active {
    transform: scale(0.98);
  }

  .mobile-menu-button {
    display: flex;
    align-items: center;
    padding: 0 0.75rem;
    height: 2rem;
    font-size: 0.875rem;
    background: linear-gradient(to top, #e5e5e5, #f5f5f5);
    color: #171717;
    border: none;
    border-radius: 9999px;
    cursor: pointer;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    transition: all 0.2s;
  }

  .mobile-menu-button:hover {
    box-shadow:
      0 4px 6px -1px rgba(0, 0, 0, 0.1),
      0 2px 4px -2px rgba(0, 0, 0, 0.1);
    transform: scale(1.02);
  }

  @media (min-width: 640px) {
    .mobile-menu-button {
      display: none;
    }
  }
</style>

<script>
  const searchTrigger = document.querySelector(".search-trigger");
  if (searchTrigger) {
    searchTrigger.addEventListener("click", () => {
      const starlightSearch = document.querySelector("starlight-search");
      if (starlightSearch) {
        const button = starlightSearch.querySelector("button");
        if (button) button.click();
      }
    });
  }

  document.addEventListener("keydown", (e) => {
    if ((e.metaKey || e.ctrlKey) && e.key === "k") {
      e.preventDefault();
      const starlightSearch = document.querySelector("starlight-search");
      if (starlightSearch) {
        const button = starlightSearch.querySelector("button");
        if (button) button.click();
      }
    }
  });
</script>
